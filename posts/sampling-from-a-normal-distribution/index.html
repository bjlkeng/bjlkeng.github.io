<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Looking at a couple of ways to sample a normal distribution.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Sampling from a Normal Distribution | Bounded Rationality</title>
<link href="../../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/colorbox.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="http://bjlkeng.github.io/posts/sampling-from-a-normal-distribution/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="description" itemprop="description" content="Looking at a couple of ways to sample a normal distribution.">
<meta name="author" content="Brian Keng">
<link rel="prev" href="../optimal-betting-and-the-kelly-criterion/" title="Optimal Betting Strategies and The Kelly Criterion" type="text/html">
<link rel="next" href="../markov-chain-monte-carlo-mcmc-and-the-metropolis-hastings-algorithm/" title="Markov Chain Monte Carlo Methods, Rejection Sampling and the Metropolis-Hastings Algorithm" type="text/html">
<meta property="og:site_name" content="Bounded Rationality">
<meta property="og:title" content="Sampling from a Normal Distribution">
<meta property="og:url" content="http://bjlkeng.github.io/posts/sampling-from-a-normal-distribution/">
<meta property="og:description" content="Looking at a couple of ways to sample a normal distribution.">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2015-11-28T21:57:02-05:00">
<meta property="article:tag" content="normal distribution">
<meta property="article:tag" content="probability">
<meta property="article:tag" content="sampling">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://bjlkeng.github.io/">

                <span class="h1" id="blog-title">Bounded Rationality</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<p class="lead">Understanding math, machine learning, and data to a satisfactory degree.</p>
<!--
                
                <li><a href="/archive.html">Archive</a>
                <li><a href="/categories/">Tags</a>
                <li><a href="/rss.xml">RSS feed</a>

                 
-->
            </ul>
<ul class="nav navbar-nav navbar-right">
<li>
    <a href="index.ipynb" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            <div class="col-lg-9">
                
                
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Sampling from a Normal Distribution</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                    Brian Keng
            </span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2015-11-28T21:57:02-05:00" itemprop="datePublished" title="2015-11-28 21:57">2015-11-28 21:57</time></a></p>
            
        <p class="sourceline"><a href="index.ipynb" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One of the most common probability distributions is the normal (or Gaussian) distribution.  Many natural phenomena can be modeled using a normal distribution.  It's also of great importance due to its relation to the <a href="https://en.wikipedia.org/wiki/Central_limit_theorem">Central Limit Theorem</a>.</p>
<p>In this post, we'll be reviewing the normal distribution and looking at how to draw samples from it using two methods.  The first method using the central limit theorem, and the second method using the <a href="https://en.wikipedia.org/wiki/Box%E2%80%93Muller_transform">Box-Muller transform</a>.  As usual, some brief coverage of the mathematics and code will be included to help drive intuition.
<!-- TEASER_END --></p>
<h3 id="Background">Background<a class="anchor-link" href="#Background">¶</a>
</h3>
<h4 id="Normal-Distribution">Normal Distribution<a class="anchor-link" href="#Normal-Distribution">¶</a>
</h4>
<p>Let's start off first by covering some basics.  A normal distribution (also known as a Gaussian distribution) $N \sim (\mu, \sigma)$ has probability density function (PDF) and cumulative density function (CDF) shown here parameterized by its mean ($\mu$) and standard deviation ($\sigma$) <a href="#fn-1"><sup>[1]</sup></a>:</p>
<p>$$ f_N(x) = \frac{1}{\sigma \sqrt{2\pi}}e^{-\frac{(x-\mu)^2}{2\sigma^2}} \tag{1}$$
$$ F_N(x) = \int_{-\infty}^{x}f_N(t) dt  \tag{2}$$</p>
<p>The CDF doesn't have a nice closed form, so we'll just represent it here using the definition of CDF in terms of its PDF.  We can graph the PDF and CDF (images from <a href="https://en.wikipedia.org/wiki/Normal_distribution">Wikipedia</a>) using various values of the two parameters:</p>
<p><img src="../../images/normal_pdf_cdf.png" alt="PDF of Normal Distribution"></p>
<p>The normal distribution is sometimes colloquially known as the "bell curve" because of a it's symmetric hump.  A very common thing to do with a probability distribution is to <em>sample</em> from it.  In other words, we want to randomly generate numbers (i.e. $x$ values) such that the values of $x$ are in proportion to the PDF.  So for the standard normal distribution, $N \sim (0, 1) $ (the red curve in the picture above), most of the values would fall close to somewhere around $x=0$.  In fact, 68% will fall within $[-1, 1]$, 95% will fall within $[-2,2]$ and 99.7% will fall within $[-3,3]$.  This corresponds to $\sigma, 2\sigma, 3\sigma$ from the mean, see this <a href="https://en.wikipedia.org/wiki/68%E2%80%9395%E2%80%9399.7_rule">article</a> for more details.</p>
<h4 id="Central-Limit-Theorem">Central Limit Theorem<a class="anchor-link" href="#Central-Limit-Theorem">¶</a>
</h4>
<p>The central limit theorem (CLT) is quite a surprising result relating the sample average of $n$ <a href="https://en.wikipedia.org/wiki/Independent_and_identically_distributed_random_variables">independent and identically distributed</a> (i.i.d.) random variables and a normal distribution.  To state it more precisely:</p>
<blockquote>
<p>Let ${X_1, X_2, \ldots, X_n}$ be $n$ i.i.d. random variables with $E(X_i)=\mu$ 
and $Var(X_i)=\sigma^2$ and  let $S_n = \frac{X_1 + X_2 + \ldots + X_n}{n}$ be the sample 
average. Then $S_n$ approximates a normal distribution with mean of $\mu$ and 
variance of $\frac{\sigma^2}{n}$ for large $n$ (i.e. $S_n \approx N(\mu, \frac{\sigma^2}{n})$).</p>
</blockquote>
<p>The surprising result is that $X_n$ can be <em>any</em> distribution.  It isn't restricted to just normal distributions.  We can also define the standard normal distribution in terms of $S_n$ by shifting and scaling it:</p>
<p>$$ N(0,1) \approx \frac{S_n - \mu}{\frac{\sigma}{\sqrt{n}}} = \frac{\sqrt{n}(S_n - \mu)}{\sigma} \tag{3} $$</p>
<h4 id="Comparing-Distributions">Comparing Distributions<a class="anchor-link" href="#Comparing-Distributions">¶</a>
</h4>
<p>Since our goal is to implement sampling from a normal distribution, it would be nice to know if we actually did it correctly!  One common way to test if two arbitrary distributions are the same is to use the <a href="https://en.wikipedia.org/wiki/Kolmogorov%E2%80%93Smirnov_test">Kolmogorov–Smirnov test</a>.  In the basic form, we can compare a sample of points with a reference distribution to find their similarity.</p>
<p>The basic idea of the test is to first sort the points in the sample and the compute the <a href="https://en.wikipedia.org/wiki/Empirical_distribution_function">empirical CDF</a>. Next, find the largest absolute difference between any point in the empirical CDF and the theoretical reference distribution.  If the two are the same, this difference should be very small. If it's large then we can be confident that the distribution is different.  Further, this difference follows a certain distribution, which allows us to test our null hypothesis of whether our samples were drawn from the reference distribution.<br>
The following figure (from <a href="https://en.wikipedia.org/wiki/Kolmogorov%E2%80%93Smirnov_test#Kolmogorov_distribution">Wikipedia</a>) shows this more clearly:</p>
<p><img src="../../images/ks_test.png" alt="Kolmogorov–Smirnov test"></p>
<p>Fortunately, we don't have to implement this ourselves.  A package is available in <a href="http://docs.scipy.org/doc/scipy/reference/tutorial/stats.html">scipy.stats</a>.  Let's play around with it a bit to see how it works.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [290]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span> 

<span class="c1"># number of samples</span>
<span class="n">N</span><span class="o">=</span><span class="mi">10000</span>

<span class="c1"># Run Kolmogorov-Smirnov test Uniform(0,1) vs. reference N(0, 1)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">uniform</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
<span class="n">test_stat</span><span class="p">,</span> <span class="n">pvalue</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">kstest</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="s1">'norm'</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"U(0,1) vs. N(0, 1): KS=</span><span class="si">%.4f</span><span class="s2"> with p-value = </span><span class="si">%.4f</span><span class="s2">."</span> <span class="o">%</span> <span class="p">(</span><span class="n">test_stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">))</span>

<span class="c1"># Run Kolmogorov-Smirnov test N(0, 2) vs. reference N(0, 1)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span> 
<span class="n">test_stat</span><span class="p">,</span> <span class="n">pvalue</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">kstest</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="s1">'norm'</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"N(0,2) vs. N(0, 1): KS=</span><span class="si">%.4f</span><span class="s2"> with p-value = </span><span class="si">%.4f</span><span class="s2">."</span> <span class="o">%</span> <span class="p">(</span><span class="n">test_stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">))</span>

<span class="c1"># Run Kolmogorov-Smirnov test N(0, 1) vs. reference N(0, 1)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span> 
<span class="n">test_stat</span><span class="p">,</span> <span class="n">pvalue</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">kstest</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="s1">'norm'</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"N(0,1) vs. N(0, 1): KS=</span><span class="si">%.4f</span><span class="s2"> with p-value = </span><span class="si">%.4f</span><span class="s2">."</span> <span class="o">%</span> <span class="p">(</span><span class="n">test_stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>U(0,1) vs. N(0, 1): KS=0.5000 with p-value = 0.0000.
N(0,2) vs. N(0, 1): KS=0.1673 with p-value = 0.0000.
N(0,1) vs. N(0, 1): KS=0.0104 with p-value = 0.2288.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using $N(0,1)$ as our reference distribution, the KS test has a large value and a negligible p-value when comparing to a uniform distribution $U(0,1)$ ($KS=0.5$).  The normal distribution with a wider base $N(0, 2)$ ($KS=0.1673$) also has a negligible p-value.  However, when we compare samples from the identical distribution $N(0,1)$, we get a relatively small value ($KS=0.0104$) for the test statistic and a large p-value, indicating we don't have sufficient evidence to reject the null hypothesis (that our two distributions are the same).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sampling-using-the-Central-Limit-Theorem">Sampling using the Central Limit Theorem<a class="anchor-link" href="#Sampling-using-the-Central-Limit-Theorem">¶</a>
</h3>
<p>Now let's try to use the Central Limit Theorem to sample from $N(0,1)$.  First let's define our i.i.d. variable $X_n$ to have a <a href="https://en.wikipedia.org/wiki/Bernoulli_distribution">Bernoulli distribution</a> with $p=0.5$, which we can intuitively think of tossing an unbiased coin:</p>
<p>$$ P(X_n=k) = \begin{cases} p=0.5 &amp; \text{if }k=1, \\[6pt] 1-p = 0.5 &amp; \text {if }k=0.\end{cases}&lt;/math&gt; \tag{4} $$</p>
<p>Recall, the Bernoulli distribution is closely relates to the <a href="https://en.wikipedia.org/wiki/Binomial_distribution">Binomial distribution</a> denoted by $B(n, p)$ by $Bernoulli(p) = B(n=1, p)$ .  The Binomial distribution can intuitively be thought of as counting the number of heads in $n$ tosses of a coin (i.e. Bernoulli trials).  If $n=1$, it reduces to a Bernoulli distribution (or single coin toss).</p>
<p>Let's now define our sample average for $n$ tosses of our unbiased coin:</p>
<p>$$ S_n = \frac{X_1 + X_2 + \ldots + X_n}{n} = \frac{B(n, p=0.5)}{n} $$</p>
<p>We can see that this distribution has $\mu=\frac{n}{2}$ (we expect half our tosses to be heads), and $\sigma^2=\frac{p(1-p)}{n}=\frac{0.25}{n}$ (Bernoulli RVs have $\sigma^2 = p(1-p)$).</p>
<p>Shifting and scaling<a href="#fn-2"><sup>[2]</sup></a> this to get our standard normal distribution using Equation 3, we get:</p>
<p>\begin{align} 
N(0,1) &amp;\approx \frac{\sqrt{n}(S_n - \mu)}{\sigma} \\
       &amp;= \frac{\sqrt{n}(\frac{X_1 + X_2 + \ldots + X_n}{n} - 0.5)}{\sqrt{0.25}} \\
       &amp;= 2\sqrt{n}(\frac{X_1 + X_2 + \ldots + X_n}{n} - 0.5) \tag{5}
\end{align}</p>
<p>Theoretically, this should give us an equation to roughly simulate a standard normal distribution.  Let's try it!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [289]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">N</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">bernoulli</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Our sample function of N(0,1) using Equation 5</span>
<span class="k">def</span> <span class="nf">sampleN_v1</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">2500</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">bernoulli</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">))</span> <span class="o">/</span> <span class="n">N</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Use KS to test again</span>
<span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">sampleN_v1</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
<span class="n">test_stat</span><span class="p">,</span> <span class="n">pvalue</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">kstest</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="s1">'norm'</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"sample_N(0,1) vs. N(0, 1): KS=</span><span class="si">%.4f</span><span class="s2"> with p-value = </span><span class="si">%.4f</span><span class="s2">."</span> <span class="o">%</span> <span class="p">(</span><span class="n">test_stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">))</span>

<span class="c1"># Let's plot our samples against our reference distribution</span>
<span class="n">reference</span> <span class="o">=</span> <span class="p">[</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'sample_N'</span><span class="p">:</span> <span class="n">samples</span><span class="p">,</span> <span class="s1">'N(0,1)'</span><span class="p">:</span> <span class="n">reference</span><span class="p">})</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">'hist'</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>sample_N(0,1) vs. N(0, 1): KS=0.0114 with p-value = 0.1499.
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt output_prompt">Out[289]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f62c4dd4e80&gt;</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0ADPrt2KTiUAoAAAAASUVORK5CYII=">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our KS score is somewhat close to $0$ with a p-value that suggests we can't reject our null hypothesis.  Graphing our implementation of $N(0,1)$ with the reference one shows that we have the roughly the right shape.  No doubt by setting larger $N$ (for both the number of Bernoulli trials and the number of samples drawn), we would get something much closer.</p>
<p>One large downside of our CLT implementation is that it's <em>slow</em>.  While the wall clock time of drawing $10000$ samples using the <code>numpy</code> library is unnoticeable, it takes roughly ten seconds on my machine with the parameters above using our CLT implementation, quite a big difference.  In the next section, we'll see a much more efficient implementation that uses a "trick" to transform a pair of independent uniform random variables to a pair of independent normal random variables.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sampling-using-the-Box-Muller-Transform">Sampling using the Box-Muller Transform<a class="anchor-link" href="#Sampling-using-the-Box-Muller-Transform">¶</a>
</h3>
<p>The <a href="https://en.wikipedia.org/wiki/Box%E2%80%93Muller_transform">Box-Muller transform</a> is a neat little "trick" that allows us to sample from a pair of normally distributed variables using a source of only uniformly distributed variables.  The transform is actually pretty simple to compute.  Given two independent uniformly distributed random variables $U_1, U_2$ on the interval $(0,1)$, we define two new random variables, $R$ and $\Theta$, that intuitively representing <a href="https://en.wikipedia.org/wiki/Polar_coordinate_system">polar coordinates</a> as such:</p>
<p>\begin{align}
R    &amp;= \sqrt{-2lnU_1}   \tag{6}\\
\Theta &amp;= 2\pi U_2  \tag{7}
\end{align}</p>
<p>Now using the standard transformation from polar coordinates $R, \Theta$ to Cartesian ones $X, Y$, we claim that $X$ and $Y$ are independent standard normally distributed random variables:</p>
<p>\begin{align}
X &amp;= Rcos\Theta &amp;= \sqrt{-2lnU_1}cos(2\pi U_2) \tag{8}\\
Y &amp;= Rsin\Theta &amp;= \sqrt{-2lnU_1}sin(2\pi U_2) \tag{9}
\end{align}</p>
<p>Let's take a look at the proof to gain some intuition on how this works.</p>
<h4 id="Proof">Proof<a class="anchor-link" href="#Proof">¶</a>
</h4>
<p>Starting with $U_1, U_2$, let's see what kind of distributions we have for $R, \Theta$.  From Equation 7, it should be clear that $\Theta$ is also uniformly distributed since it's just multiplying by a constant ($2\pi$), but let's go through the motions to explicitly see that.  From the CDF of $\Theta$:</p>
<p>\begin{align}
P(\Theta \leq \theta) &amp;= P(2\pi U_2 \leq \theta) \\
                      &amp;= P(U_2 \leq \frac{\theta}{2\pi}) \\
               \Theta &amp;\sim Uniform(0, 2\pi) \tag{10}
\end{align}</p>
<p>So we have our first result that $\Theta$ is uniformly distributed on $(0, 2\pi)$ (as we would expect).  Using a more explicit method, we can find the distribution of $R$.  From Equation 7, we know that the mapping from $U_1$ to $R$ is one-to-one, which we'll call $g$ (i.e. $R=g(U_1)$).  So if we're trying to find the probability of R over $(r_1, r_2)$ (by integrating its PDF), there is some equivalent range over $(g^{-1}(r_1), g^{-1}(r_2))$ where we can integrate over the PDF of $U_1$.  Let's see how this works <a href="#fn-3"><sup>[3]</sup></a>:</p>
<p>\begin{align}
P(r_1 \leq R \leq r_2) &amp;=  \int_{g^{-1}(r_2)}^{g^{-1}(r_1)} f_{U_1}(s) ds  &amp;&amp; \text{since } g(x) \text{ is strictly decreasing}\\
                       &amp;=  -\int_{g^{-1}(r_1)}^{g^{-1}(r_2)}  ds &amp;&amp; \text{since }f_{U_1}(u)=1 \\
                       &amp;=  -\int_{r_1}^{r_2} -t e^{\frac{-t^2}{2}} dt &amp;&amp; \text{change variables } t=\sqrt{-2\ln s}\tag{11} \\
                f_R(r) &amp;=  r e^{\frac{-r^2}{2}}  \tag{12}
\end{align}</p>
<p>giving us the PDF for $R$, $f_R(r)$<a href="#fn-4"><sup>[4]</sup></a>.  It should also be clear that $R$ and $\Theta$ are independent because $U_1$ and $U_2$ are independent.</p>
<p>Now that we have the distributions for both $R$ and $\Theta$, let's label Equation 8 and 9 as $X=g_x(R, \Theta)$ and $Y=g_y(R, \Theta)$, respectively.  Now we can apply the same procedure as above using variable substitution (for multiple variables) to derive the joint distribution of $X$ and $Y$ (we'll represent the 
area in the transformed space by $A$<a href="#fn-5"><sup>[5]</sup></a>):</p>
<p>\begin{align}
P(x_1 &amp;\leq X \leq x_2, y_1 \leq Y \leq y_2) \\
    &amp;= \int \int_A f_{R,\Theta}(u, v) du dv \\
    &amp;= \int \int_A f_{R}(u)f_{\Theta}(v) du dv &amp;&amp; \text{since } R \text{ and } \Theta \text{ are independent} \\ 
    &amp;= \int \int_A ue^{\frac{-u^2}{2}}\frac{1}{2\pi} du dv \tag{13}
\end{align}</p>
<p>At this point, we should remember that if $p=ucos(v), q=usin(v)$, then solving for $u,v$ results in $u=\sqrt{q^2+p^2}, v=arctan(\frac{q}{p})$.  Also, <a href="https://en.wikipedia.org/wiki/Integration_by_substitution#Substitution_for_multiple_variables">substitution for multiple variables</a> means that $du dv = |det(\frac{\partial(u,v)}{\partial(p, q)})| dp dq$, plugging our expressions for $u$ and $v$ in:</p>
<p>\begin{align}
du dv &amp;= |det(\frac{\partial(u,v)}{\partial(p, q)})| dp dq \\
      &amp;= 
\left |
\begin{array}{cc}
\frac{\partial u}{\partial p} &amp; \frac{\partial u}{\partial q} \\
\frac{\partial v}{\partial p} &amp; \frac{\partial v}{\partial q}
\end{array}
\right | dpdq \\
      &amp;= 
\left |
\begin{array}{cc}
\frac{\partial \sqrt{q^2+p^2}}{\partial p} &amp; \frac{\partial \sqrt{q^2+p^2}}{\partial q} \\
\frac{\partial arctan(\frac{q}{p})}{\partial p} &amp; \frac{\partial arctan(\frac{q}{p})}{\partial q}
\end{array}
\right | dpdq \\
      &amp;= 
\left |
\begin{array}{cc}
\frac{p}{\sqrt{p^2+q^2}} &amp; \frac{q}{\sqrt{p^2+q^2}} \\
\frac{-q}{p^2(1+(\frac{q}{p})^2)} &amp; \frac{1}{p(1+(\frac{q}{p})^2)}
\end{array}
\right | dpdq \\
      &amp;= \frac{1}{\sqrt{p^2 + q^2}} dpdq \tag{14}
\end{align}</p>
<p>Using the result from Equation 14 into Equation 13, we get:</p>
<p>\begin{align}
P(&amp;x_1 \leq X \leq x_2, y_1 \leq Y \leq y_2) &amp;&amp; \text{change variables} \\
    &amp;= \int_{x_1}^{x_2} \int_{y_1}^{y_2} \frac{\sqrt{p^2 + q^2}}{2\pi}\cdot e^{\frac{-(p^2 + q^2)}{2}} \cdot \frac{1}{\sqrt{p^2 + q^2}} dp dq  &amp;&amp; p=ucos(v)  \\
    &amp;                     &amp;&amp; q=usin(v) \\
    &amp;= \int_{x_1}^{x_2} \underbrace{\frac{1}{\sqrt{2\pi}} e^{\frac{-p^2}{2}}}_{f_X(x)} dp \int_{y_1}^{y_2} \underbrace{\frac{1}{\sqrt{2\pi}} e^{\frac{-q^2}{2}}}_{f_Y(y)} dq  \tag{15}
\end{align}</p>
<p>Equation 15 shows that $X$ and $Y$ are independent each with PDF matching our standard normal distribution $N(0,1)$ as required.</p>
<h4 id="Implementing-Box-Muller-Transform">Implementing Box-Muller Transform<a class="anchor-link" href="#Implementing-Box-Muller-Transform">¶</a>
</h4>
<p>The implementation is a relatively straight forward application of Equation 8 and 9:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [288]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">N</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">epsilon</span>

<span class="k">def</span> <span class="nf">box_muller</span><span class="p">():</span>
    <span class="c1"># Avoid getting u == 0.0</span>
    <span class="n">u1</span><span class="p">,</span> <span class="n">u2</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>
    <span class="k">while</span> <span class="n">u1</span> <span class="o">&lt;</span> <span class="n">epsilon</span> <span class="ow">or</span> <span class="n">u2</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
        <span class="n">u1</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
        <span class="n">u2</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
        
    <span class="n">n1</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">u1</span><span class="p">))</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">u2</span><span class="p">)</span>
    <span class="n">n2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">u1</span><span class="p">))</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">u2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span>


<span class="c1"># Use KS to test</span>
<span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">box_muller</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
<span class="n">test_stat</span><span class="p">,</span> <span class="n">pvalue</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">kstest</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="s1">'norm'</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"sample_N(0,1) vs. N(0, 1): KS=</span><span class="si">%.4f</span><span class="s2"> with p-value = </span><span class="si">%.4f</span><span class="s2">."</span> <span class="o">%</span> <span class="p">(</span><span class="n">test_stat</span><span class="p">,</span> <span class="n">pvalue</span><span class="p">))</span>

<span class="c1"># Plot our samples against our reference distribution</span>
<span class="n">reference</span> <span class="o">=</span> <span class="p">[</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'sample_N'</span><span class="p">:</span> <span class="n">samples</span><span class="p">,</span> <span class="s1">'N(0,1)'</span><span class="p">:</span> <span class="n">reference</span><span class="p">})</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">'hist'</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>sample_N(0,1) vs. N(0, 1): KS=0.0074 with p-value = 0.6372.
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt output_prompt">Out[288]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f62c509fcc0&gt;</pre>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0AUGIQEZEM/x9tz0yjypI29gAAAABJRU5ErkJggg==">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we can see, our Box-Muller method of sampling from $ N(0,1) $ generates quite good results.  Our KS test statistic is quite small along with a large p-value (so we can't reject our null hypothesis).  Similarly, the graph shows the expected shape matching our reference distribution.  The one big advantage this method has though is that it's quite fast.  There's no noticeable lag when generating (N=10000) samples.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Conclusion">Conclusion<a class="anchor-link" href="#Conclusion">¶</a>
</h3>
<p>Generating pseudo-random numbers according to various probability distributions has many applications, for example, in Markov Chain Monte Carlo (MCMC) techniques.  In this post, we looked at one of the most fundamental distributions: the standard normal distribution.  Our first method uses a result directly from the central limit theorem which results in an inefficient implementation.  However with a bit of grit and calculus, we were able to show that the Box-Muller transform provides a much more elegant solution to sampling from a standard normal distribution leading us to an efficient implementation.  Hopefully this sheds some light on how to sample a normal distribution.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="References-and-Further-Reading">References and Further Reading<a class="anchor-link" href="#References-and-Further-Reading">¶</a>
</h3>
<ul>
<li>Wikipedia: <a href="https://en.wikipedia.org/wiki/Normal_distribution">Normal Distribution</a>, <a href="https://en.wikipedia.org/wiki/Box%E2%80%93Muller_transform">Box-Muller Transform</a>, <a href="https://en.wikipedia.org/wiki/Central_limit_theorem">Central Limit Theorem</a>, <a href="https://en.wikipedia.org/wiki/Integration_by_substitution#Substitution_for_multiple_variables">Substitution for multiple variables</a>, <a href="https://en.wikipedia.org/wiki/Determinant#2.C2.A0.C3.97.C2.A02_matrices">Determinant of 2x2 matrices</a>, <a href="https://en.wikipedia.org/wiki/Jacobian_matrix_and_determinant">Jacobian matrix and determinant</a>
</li>
<li>Stack Exchange: <a href="http://stats.stackexchange.com/questions/16334/how-to-sample-from-a-normal-distribution-with-known-mean-and-variance-using-a-co">How to sample from a normal distribution with known mean and variance using a conventional programming language?</a>, <a href="http://math.stackexchange.com/questions/1110168/proof-of-the-box-muller-method">Proof of Box-Muller method</a>
</li>
<li>
<a href="http://www.math.uah.edu/stat/dist/Transformations.html">Transformations of Random Variables</a> (University of Alabama Huntsville)</li>
<li>
<a href="http://tutorial.math.lamar.edu/Classes/CalcIII/ChangeOfVariables.aspx">Change of Variables</a> (Paul's Online Math Notes)</li>
<li>
<a href="http://www.math.nyu.edu/faculty/goodman/teaching/MonteCarlo2005/notes/GaussianSampling.pdf">Simple Sampling of Gaussians</a> (Jonathan Goodman, NYU)</li>
</ul>
<h3 id="Notes">Notes<a class="anchor-link" href="#Notes">¶</a>
</h3>
<p>List of Notes: <sup class="footnote-ref" id="fnref-1"><a href="#fn-1">1</a></sup>, <sup class="footnote-ref" id="fnref-2"><a href="#fn-2">2</a></sup>, <sup class="footnote-ref" id="fnref-3"><a href="#fn-3">3</a></sup>, <sup class="footnote-ref" id="fnref-4"><a href="#fn-4">4</a></sup>, <sup class="footnote-ref" id="fnref-5"><a href="#fn-5">5</a></sup></p>
<div class="footnotes">
<hr>
<ol>
<li id="fn-1"><p>We'll use the convention of $f_X(x)$ and $F_X(x)$ to denote the PDF and CDF of random variable X, respectively.<a href="#fnref-1" class="footnote">↩</a></p></li>
<li id="fn-2"><p>If we got back to the definitions of mean and variance, we can see this shifting and scaling yields the correct result.  $E(\frac{\sqrt{n}(S_n - \mu)}{\sigma}) = \frac{\sqrt{n}(E(S_n) - \mu)}{\sigma} = 0$ since $E(S_n)=\mu$ by definition.  And $Var(\frac{\sqrt{n}(S_n - \mu)}{\sigma}) = \frac{n}{\sigma^2}(E((S_n - \mu)^2) - (E(S_n - \mu))^2 = \frac{n}{\sigma^2} \frac{\sigma^2}{n} = 1 $<a href="#fnref-2" class="footnote">↩</a></p></li>
<li id="fn-3"><p>We use $s, t$ for the dummy variables of $U_1, R$ respectively.  You might also need a refresher on <a href="https://en.wikipedia.org/wiki/Integration_by_substitution">integration by substitution</a> like I did.  Also notice that we flipped the integral endpoints of $g^{-1}(r1)$ and $g^{-1}(r2)$ because $g(x)$ is a strictly decreasing function, so the lower limit $r_1$ maps to the upper limit $g^{-1}(r_1)$ in the transformed function.  Similarly with $r_2$ and $g^{-1}(r_2)$.<a href="#fnref-3" class="footnote">↩</a></p></li>
<li id="fn-4"><p>Our result is actually a specific case of a more general result when transforming from one probability distribution.  Take a look at <a href="http://www.math.uah.edu/stat/dist/Transformations.html">Transformations of Random Variables</a> for more details and examples.<a href="#fnref-4" class="footnote">↩</a></p></li>
<li id="fn-5"><p>Remember that the rectangular area represented by $(x_1, x_2)$ and $(y_1, y_2)$ is non-rectagular when we transform it into the $R$ and $\Theta$ space.  This means that we're no longer integrating just along $R$ and $\Theta$ separately but together along the new oddly shaped area, thus the need to use $A$ to represent the area.<a href="#fnref-5" class="footnote">↩</a></p></li>
</ol>
</div>

</div>
</div>
</div>
    </div>
  </div>

    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/normal-distribution/" rel="tag">normal distribution</a></li>
            <li><a class="tag p-category" href="../../categories/probability/" rel="tag">probability</a></li>
            <li><a class="tag p-category" href="../../categories/sampling/" rel="tag">sampling</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../optimal-betting-and-the-kelly-criterion/" rel="prev" title="Optimal Betting Strategies and The Kelly Criterion">Previous post</a>
            </li>
            <li class="next">
                <a href="../markov-chain-monte-carlo-mcmc-and-the-metropolis-hastings-algorithm/" rel="next" title="Markov Chain Monte Carlo Methods, Rejection Sampling and the Metropolis-Hastings Algorithm">Next post</a>
            </li>
        </ul></nav></aside><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script><script type="text/x-mathjax-config">
                    MathJax.Hub.Config({
                        tex2jax: {
                            inlineMath: [ ['$','$'], ["\\\(","\\\)"] ],
                            displayMath: [ ['$$','$$'], ["\\\[","\\\]"] ],
                            processEscapes: true
                        },
                        displayAlign: 'left', // Change this to 'center' to center equations.
                        "HTML-CSS": {
                            styles: {'.MathJax_Display': {"margin": 0}}
                        }
                    });
                    </script></article>
</div>
            <div class="col-md-3 well">
            <p>
            I'm <a href="http://www.briankeng.com/about">Brian Keng</a>, 
            a former academic, current data scientist and engineer.  This is
            <a href="../../">the place</a>
            where I write
            about all things technical.
            </p>
            <p>
            Twitter: <a href="http://www.twitter.com/bjlkeng">@bjlkeng</a>
            </p>

            <br><p>
            <a href="../../archive.html">Archive</a>
            </p>
            <p>
            <a href="../../categories/index.html">Tags</a>
            </p>
            <p>
            <a href="../../rss.xml">RSS feed</a>
            </p>

<!-- Begin MailChimp Signup Form -->
<hr>
<link href="//cdn-images.mailchimp.com/embedcode/classic-081711.css" rel="stylesheet" type="text/css">
<style type="text/css">
    #mc_embed_signup{clear:left; font:13px Helvetica,Arial,sans-serif; }
    /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
       We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
<form action="//briankeng.us10.list-manage.com/subscribe/post?u=cedf72ca8daa891e57f4379a0&amp;id=1f1563094f" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <b>Signup for Email Blog Posts</b>
    <div id="mc_embed_signup_scroll">
<div>
    <label for="mce-EMAIL"> Email Address </label>
    <input type="email" value="" name="EMAIL" class="required email form-control input-sm" id="mce-EMAIL">
</div>
    <div id="mce-responses" class="clear">
        <div class="response" id="mce-error-response" style="display:none"></div>
        <div class="response" id="mce-success-response" style="display:none"></div>
    </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_cedf72ca8daa891e57f4379a0_1f1563094f" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="btn btn-default btn-xs"></div>
    </div>
</form>
</div>
<script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';fnames[1]='FNAME';ftypes[1]='text';fnames[2]='LNAME';ftypes[2]='text';}(jQuery));var $mcj = jQuery.noConflict(true);</script><!--End mc_embed_signup-->
</div>
        </div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2019         <a href="mailto:brian@briankeng.com">Brian Keng</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


            <script src="../../assets/js/jquery.min.js"></script><script src="../../assets/js/bootstrap.min.js"></script><script src="../../assets/js/moment-with-locales.min.js"></script><script src="../../assets/js/fancydates.js"></script><script src="../../assets/js/jquery.colorbox-min.js"></script><!-- <script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script> --><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-15314898-2', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>
